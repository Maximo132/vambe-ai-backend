2025-06-19 10:11:53,529 - INFO - Conectando a la base de datos: postgresql+psycopg2://chatbot_user:chatbot_password@localhost:5432/chatbot_db
2025-06-19 10:11:54,502 - INFO - Probando conexión...
2025-06-19 10:11:58,605 - ERROR - Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\impl.py", line 180, in _do_get
    self._dec_overflow()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\flow\backend\chatbot-api\test_db.py", line 35, in main
    with engine.connect() as conn:
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\impl.py", line 180, in _do_get
    self._dec_overflow()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-19 10:13:24,345 - INFO - Conectando a la base de datos: postgresql+psycopg2://chatbot_user:chatbot_password@localhost:5432/chatbot_db
2025-06-19 10:13:25,237 - INFO - Probando conexión...
2025-06-19 10:13:25,467 - INFO - select pg_catalog.version()
2025-06-19 10:13:25,468 - INFO - [raw sql] {}
2025-06-19 10:13:25,476 - INFO - select current_schema()
2025-06-19 10:13:25,477 - INFO - [raw sql] {}
2025-06-19 10:13:25,483 - INFO - show standard_conforming_strings
2025-06-19 10:13:25,483 - INFO - [raw sql] {}
2025-06-19 10:13:25,487 - INFO - Conexión exitosa
2025-06-19 10:13:25,487 - ERROR - Error: Not an executable object: "SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'"
Traceback (most recent call last):
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1411, in execute
    meth = statement._execute_on_connection
AttributeError: 'str' object has no attribute '_execute_on_connection'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\flow\backend\chatbot-api\test_db.py", line 39, in main
    result = conn.execute("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'")
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1413, in execute
    raise exc.ObjectNotExecutableError(statement) from err
sqlalchemy.exc.ObjectNotExecutableError: Not an executable object: "SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'"
2025-06-19 10:14:21,415 - INFO - Conectando a la base de datos: postgresql+psycopg2://chatbot_user:chatbot_password@localhost:5432/chatbot_db
2025-06-19 10:14:22,268 - INFO - Probando conexión...
2025-06-19 10:14:22,450 - INFO - select pg_catalog.version()
2025-06-19 10:14:22,451 - INFO - [raw sql] {}
2025-06-19 10:14:22,462 - INFO - select current_schema()
2025-06-19 10:14:22,463 - INFO - [raw sql] {}
2025-06-19 10:14:22,467 - INFO - show standard_conforming_strings
2025-06-19 10:14:22,468 - INFO - [raw sql] {}
2025-06-19 10:14:22,472 - INFO - Conexión exitosa
2025-06-19 10:14:22,472 - INFO - Consultando tablas...
2025-06-19 10:14:22,473 - ERROR - Error: Not an executable object: "\n                SELECT table_name \n                FROM information_schema.tables \n                WHERE table_schema = 'public'\n            "
Traceback (most recent call last):
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1411, in execute
    meth = statement._execute_on_connection
AttributeError: 'str' object has no attribute '_execute_on_connection'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\flow\backend\chatbot-api\test_db.py", line 40, in main
    result = conn.execute("""
  File "C:\Users\maxva\AppData\Local\Programs\Python\Python39\lib\site-packages\sqlalchemy\engine\base.py", line 1413, in execute
    raise exc.ObjectNotExecutableError(statement) from err
sqlalchemy.exc.ObjectNotExecutableError: Not an executable object: "\n                SELECT table_name \n                FROM information_schema.tables \n                WHERE table_schema = 'public'\n            "
